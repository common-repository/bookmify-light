!function(e){"use strict";var a={ajaxurl:bookmifyConfig.ajaxUrl,employee:bookmifyConfig.employee,cacheElements:function(){this.cache={filterService:"all",filterEmployee:"all",filterStartDate:"",filterEndDate:"",servicesIDs:[],customerID:"",employeeID:"",status:"",filters:e(".bookmify_be_calendar .bookmify_be_calendars_filter"),allFilters:e(".bookmify_be_calendar .bookmify_be_filter_list"),filterServiceList:e(".bookmify_be_calendar .bookmify_be_services_filter_list"),filterServiceWrap:e(".bookmify_be_calendar .bookmify_be_filter_list.services"),filterCustomerList:e(".bookmify_be_calendar .bookmify_be_filter_popup_list.customers"),filterCustomerWrap:e(".bookmify_be_calendar .bookmify_be_filter_list.customers"),filterEmployeeList:e(".bookmify_be_calendar .bookmify_be_filter_popup_list.employees"),filterEmployeeWrap:e(".bookmify_be_calendar .bookmify_be_filter_list.employees"),filterStatusList:e(".bookmify_be_calendar .bookmify_be_filter_popup_list.status"),filterStatusWrap:e(".bookmify_be_calendar .bookmify_be_filter_list.status")},this.cache.filterServiceInput=this.cache.filterServiceWrap.find(".filter_list"),this.cache.filterServiceInputPlaceholder=this.cache.filterServiceInput.attr("data-placeholder"),this.cache.filterCustomerInput=this.cache.filterCustomerWrap.find(".filter_list"),this.cache.filterCustomerInputPlaceholder=this.cache.filterCustomerInput.attr("data-placeholder"),this.cache.filterEmployeeInput=this.cache.filterEmployeeWrap.find(".filter_list"),this.cache.filterEmployeeInputPlaceholder=this.cache.filterEmployeeInput.attr("data-placeholder"),this.cache.filterStatusInput=this.cache.filterStatusWrap.find(".filter_list"),this.cache.filterStatusInputPlaceholder=this.cache.filterStatusInput.attr("data-placeholder")},init:function(){this.cacheElements(),this.imgToSvg(),this.bookmifyBeInitCalendar(),this.doFilter(),this.perfectScrollBar()},getEvents:function(){var a=this;e(".bookmify_be_fullcalendar").fullCalendar("removeEventSources"),e(".bookmify_be_fullcalendar_wrap").addClass("await");var t={action:"ajaxAppointmentListCalendar",bookmify_startDate:a.cache.filterStartDate,bookmify_endDate:a.cache.filterEndDate,bookmify_services:a.cache.servicesIDs,bookmify_customer:a.cache.customerID,bookmify_employee:a.cache.employeeID,bookmify_status:a.cache.status};e.ajax({type:"POST",url:a.ajaxurl,cache:!0,data:t,success:function(e){a.bookmifyBeCalendarAjax(e)},error:function(){}})},doFilter:function(){var a=this;e(window).on("click",function(){a.cache.filterServiceWrap.removeClass("opened")}),a.cache.filterServiceWrap.on("click",function(e){e.preventDefault(),e.stopPropagation(),a.cache.filterCustomerWrap.removeClass("opened"),a.cache.filterEmployeeWrap.removeClass("opened"),a.cache.filterStatusWrap.removeClass("opened"),a.cache.filterServiceWrap.addClass("opened")});var t=null;a.cache.filterServiceList.children("div").off().on("click",function(){var r=e(this),l=r.data("id");return r.hasClass("sending")?(r.removeClass("sending"),a.cache.servicesIDs=e.grep(a.cache.servicesIDs,function(e){return e!==l})):(r.addClass("sending"),a.cache.servicesIDs.push(l)),clearTimeout(t),a.checkNewValueForServiceFilterInEmployee(),t=setTimeout(function(){a.cache.filters.addClass("filtered"),a.cache.filterServiceWrap.addClass("filtered"),a.getEvents(),a.cache.filterServiceWrap.removeClass("opened"),a.cache.servicesIDs.length||(a.cache.filterServiceWrap.removeClass("filtered"),a.cache.allFilters.hasClass("filtered")||a.cache.filters.removeClass("filtered"))},700),!1}),a.cache.filterServiceWrap.find(".icon").off().on("click",function(e){e.preventDefault(),e.stopPropagation(),a.cache.filterCustomerWrap.removeClass("opened"),a.cache.filterEmployeeWrap.removeClass("opened"),a.cache.filterStatusWrap.removeClass("opened"),a.cache.filterServiceInput.attr("placeholder",a.cache.filterServiceInputPlaceholder),a.cache.filterServiceInput.siblings(".bookmify_be_new_value").html(""),a.cache.filterServiceWrap.removeClass("ready"),a.cache.filterServiceList.children("div").removeClass("sending"),a.cache.servicesIDs=[],a.cache.filterServiceWrap.removeClass("opened"),a.cache.filterServiceWrap.removeClass("filtered"),a.cache.allFilters.hasClass("filtered")||a.cache.filters.removeClass("filtered"),a.getEvents()}),e(window).on("click",function(){a.cache.filterCustomerWrap.removeClass("opened")}),a.cache.filterCustomerWrap.on("click",function(e){e.preventDefault(),e.stopPropagation(),a.cache.filterServiceWrap.removeClass("opened"),a.cache.filterEmployeeWrap.removeClass("opened"),a.cache.filterStatusWrap.removeClass("opened"),a.cache.filterCustomerWrap.addClass("opened")}),a.cache.filterCustomerInput.off().on("keyup",function(t){t.preventDefault(),t.stopPropagation();var r,l,c=e(this).val().toUpperCase(),i=a.cache.filterCustomerList.children(),s=i.children("div.item"),o=0,n=i.find(".no_records");for(""!==c?a.cache.filterCustomerWrap.addClass("ready clear"):a.cache.filterCustomerWrap.removeClass("ready clear"),l=0;l<s.length;l++)((r=s[l].getElementsByTagName("span")[0]).textContent||r.innerText).toUpperCase().indexOf(c)>-1?(s[l].style.display="",o--):(s[l].style.display="none",o++);o!==s.length||n.length?o!==s.length&&i.find(".no_records").remove():i.append('<div class="no_records"><span>No Records</span></div>')}),a.cache.filterCustomerList.children().children("div").off().on("click",function(){var t=e(this),r=t.data("id"),l=t.find("span").html();return t.hasClass("sending")||(t.addClass("sending"),a.cache.customerID=r,t.siblings().removeClass("sending"),a.cache.filterCustomerInput.attr("placeholder",""),a.cache.filterCustomerInput.attr("value",l),a.cache.filterCustomerWrap.addClass("ready"),a.cache.filterCustomerWrap.removeClass("opened"),a.cache.filters.addClass("filtered"),a.cache.filterCustomerWrap.addClass("filtered"),a.getEvents()),!1}),a.cache.filterCustomerWrap.find(".icon").off().on("click",function(e){e.preventDefault(),e.stopPropagation(),a.cache.filterServiceWrap.removeClass("opened"),a.cache.filterEmployeeWrap.removeClass("opened"),a.cache.filterStatusWrap.removeClass("opened"),a.cache.filterCustomerInput.attr("placeholder",a.cache.filterCustomerInputPlaceholder),a.cache.filterCustomerInput.attr("value",""),a.cache.filterCustomerList.children().children("div").removeClass("sending").css("display",""),""!==a.cache.customerID?(a.cache.customerID="",a.getEvents(),a.cache.filterCustomerWrap.removeClass("opened"),a.cache.filterCustomerWrap.removeClass("filtered"),a.cache.allFilters.hasClass("filtered")||a.cache.filters.removeClass("filtered")):a.cache.filterCustomerInput.frenifyMoveCursorToEnd(),a.cache.filterCustomerWrap.removeClass("ready"),a.cache.filterCustomerWrap.removeClass("clear"),a.cache.filterCustomerList.children().find(".no_records").remove()}),e(window).on("click",function(){a.cache.filterEmployeeWrap.removeClass("opened")}),a.cache.filterEmployeeWrap.on("click",function(e){e.preventDefault(),e.stopPropagation(),a.cache.filterServiceWrap.removeClass("opened"),a.cache.filterCustomerWrap.removeClass("opened"),a.cache.filterStatusWrap.removeClass("opened"),a.cache.filterEmployeeWrap.addClass("opened")}),a.cache.filterEmployeeInput.off().on("keyup",function(t){t.preventDefault(),t.stopPropagation();var r,l,c=e(this).val().toUpperCase(),i=a.cache.filterEmployeeList.children(),s=i.children("div.item"),o=0,n=i.find(".no_records");for(""!==c?a.cache.filterEmployeeWrap.addClass("ready clear"):a.cache.filterEmployeeWrap.removeClass("ready clear"),l=0;l<s.length;l++)((r=s[l].getElementsByTagName("span")[0]).textContent||r.innerText).toUpperCase().indexOf(c)>-1?(s[l].style.display="",o--):(s[l].style.display="none",o++);o!==s.length||n.length?o!==s.length&&i.find(".no_records").remove():i.append('<div class="no_records"><span>No Records</span></div>')}),a.cache.filterEmployeeList.children().children("div").off().on("click",function(){var t=e(this),r=t.data("id"),l=t.find("span").html();return t.hasClass("sending")||(t.addClass("sending"),a.cache.employeeID=r,t.siblings().removeClass("sending"),a.cache.filterEmployeeInput.attr("placeholder",""),a.cache.filterEmployeeInput.attr("value",l),a.cache.filterEmployeeWrap.addClass("ready"),a.cache.filterEmployeeWrap.removeClass("opened"),a.cache.filters.addClass("filtered"),a.cache.filterEmployeeWrap.addClass("filtered"),a.getEvents()),!1}),a.cache.filterEmployeeWrap.find(".icon").off().on("click",function(e){e.preventDefault(),e.stopPropagation(),a.cache.filterServiceWrap.removeClass("opened"),a.cache.filterCustomerWrap.removeClass("opened"),a.cache.filterStatusWrap.removeClass("opened"),a.cache.filterEmployeeInput.attr("placeholder",a.cache.filterEmployeeInputPlaceholder),a.cache.filterEmployeeInput.attr("value",""),a.cache.filterEmployeeList.children().children("div").removeClass("sending").css("display",""),""!==a.cache.employeeID?(a.cache.employeeID="",a.getEvents(),a.cache.filterEmployeeWrap.removeClass("opened"),a.cache.filterEmployeeWrap.removeClass("filtered"),a.cache.allFilters.hasClass("filtered")||a.cache.filters.removeClass("filtered")):a.cache.filterEmployeeInput.frenifyMoveCursorToEnd(),a.cache.filterEmployeeWrap.removeClass("ready"),a.cache.filterEmployeeWrap.removeClass("clear"),a.cache.filterEmployeeWrap.children().find(".no_records").remove()}),e(window).on("click",function(){a.cache.filterStatusWrap.removeClass("opened")}),a.cache.filterStatusWrap.on("click",function(e){e.preventDefault(),e.stopPropagation(),a.cache.filterServiceWrap.removeClass("opened"),a.cache.filterCustomerWrap.removeClass("opened"),a.cache.filterEmployeeWrap.removeClass("opened"),a.cache.filterStatusWrap.addClass("opened")}),a.cache.filterStatusInput.off().on("keyup",function(t){t.preventDefault(),t.stopPropagation();var r,l,c=e(this).val().toUpperCase(),i=a.cache.filterStatusList.children(),s=i.children("div.item"),o=0,n=i.find(".no_records");for(""!==c?a.cache.filterStatusWrap.addClass("ready clear"):a.cache.filterStatusWrap.removeClass("ready clear"),l=0;l<s.length;l++)((r=s[l].getElementsByTagName("span")[0]).textContent||r.innerText).toUpperCase().indexOf(c)>-1?(s[l].style.display="",o--):(s[l].style.display="none",o++);o!==s.length||n.length?o!==s.length&&i.find(".no_records").remove():i.append('<div class="no_records"><span>No Records</span></div>')}),a.cache.filterStatusList.children().children("div").off().on("click",function(){var t=e(this),r=t.data("status"),l=t.find("span").html();return t.hasClass("sending")||(t.addClass("sending"),a.cache.status=r,t.siblings().removeClass("sending"),a.cache.filterStatusInput.attr("placeholder",""),a.cache.filterStatusInput.attr("value",l),a.cache.filterStatusWrap.addClass("ready"),a.cache.filterStatusWrap.removeClass("opened"),a.cache.filters.addClass("filtered"),a.cache.filterStatusWrap.addClass("filtered"),a.getEvents()),!1}),a.cache.filterStatusWrap.find(".icon").off().on("click",function(e){e.preventDefault(),e.stopPropagation(),a.cache.filterServiceWrap.removeClass("opened"),a.cache.filterCustomerWrap.removeClass("opened"),a.cache.filterEmployeeWrap.removeClass("opened"),a.cache.filterStatusInput.attr("placeholder",a.cache.filterStatusInputPlaceholder),a.cache.filterStatusInput.attr("value",""),a.cache.filterStatusList.children().children("div").removeClass("sending").css("display",""),""!==a.cache.status?(a.cache.status="",a.getEvents(),a.cache.filterStatusWrap.removeClass("opened"),a.cache.filterStatusWrap.removeClass("filtered"),a.cache.allFilters.hasClass("filtered")||a.cache.filters.removeClass("filtered")):a.cache.filterStatusInput.frenifyMoveCursorToEnd(),a.cache.filterStatusWrap.removeClass("ready"),a.cache.filterStatusWrap.removeClass("clear"),a.cache.filterStatusWrap.children().find(".no_records").remove()}),e(".bookmify_be_calendar .bookmify_be_filter_list.reset a").off().on("click",function(t){return t.preventDefault(),t.stopPropagation(),a.cache.filters.hasClass("filtered")&&(e(".bookmify_be_fullcalendar").fullCalendar("changeView","month"),a.cache.servicesIDs=[],a.cache.customerID="",a.cache.employeeID="",a.cache.status="",a.cache.allFilters.removeClass("opened ready clear"),a.cache.filterStatusInput.attr("placeholder",a.cache.filterStatusInputPlaceholder),a.cache.filterStatusInput.attr("value",""),a.cache.filterStatusList.children().children("div").removeClass("sending").css("display",""),a.cache.filterCustomerInput.attr("placeholder",a.cache.filterCustomerInputPlaceholder),a.cache.filterCustomerInput.attr("value",""),a.cache.filterCustomerList.children().children("div").removeClass("sending").css("display",""),a.cache.filterEmployeeInput.attr("placeholder",a.cache.filterEmployeeInputPlaceholder),a.cache.filterEmployeeInput.attr("value",""),a.cache.filterEmployeeList.children().children("div").removeClass("sending").css("display",""),a.cache.filterServiceInput.attr("placeholder",a.cache.filterServiceInputPlaceholder),a.cache.filterServiceInput.siblings(".bookmify_be_new_value").html(""),a.cache.filterServiceWrap.removeClass("ready"),a.cache.filterServiceList.children("div").removeClass("sending"),a.getEvents(),a.cache.filters.removeClass("filtered"),a.cache.allFilters.removeClass("filtered")),!1})},checkNewValueForServiceFilterInEmployee:function(){if(e.isEmptyObject(this.cache.servicesIDs))this.cache.filterServiceInput.attr("placeholder",this.cache.filterServiceInputPlaceholder),this.cache.filterServiceInput.siblings(".bookmify_be_new_value").html(""),this.cache.filterServiceWrap.removeClass("ready");else{var a="";if(this.cache.filterServiceInput.attr("placeholder",""),this.cache.servicesIDs.length>1){var t=this.cache.filterServiceList.children("div").length;a='<span class="number">'+this.cache.servicesIDs.length+" / "+t+"</span>"}var r='<span class="text">'+this.cache.filterServiceList.find('div[data-id="'+this.cache.servicesIDs[0]+'"]').html()+"</span>";this.cache.filterServiceInput.siblings(".bookmify_be_new_value").html("").html(r+a),this.cache.filterServiceWrap.addClass("ready")}},bookmifyBeCalendarAjax:function(a){var t=JSON.parse(a),r=t.bookmify_be_data;e(".bookmify_be_fullcalendar").fullCalendar("removeEventSources"),e(".bookmify_be_fullcalendar").fullCalendar("addEventSource",r),e(".bookmify_be_fullcalendar_wrap").removeClass("await"),e(".bookmify_be_fullcalendar").fullCalendar("refetchEvents"),e(".bookmify_be_fullcalendar .fc-day").removeClass("bookmify_be_color"),e.each(t.ids,function(a,t){switch(t){case 1:e(".bookmify_be_fullcalendar .fc-mon").addClass("bookmify_be_color");break;case 2:e(".bookmify_be_fullcalendar .fc-tue").addClass("bookmify_be_color");break;case 3:e(".bookmify_be_fullcalendar .fc-wed").addClass("bookmify_be_color");break;case 4:e(".bookmify_be_fullcalendar .fc-thu").addClass("bookmify_be_color");break;case 5:e(".bookmify_be_fullcalendar .fc-fri").addClass("bookmify_be_color");break;case 6:e(".bookmify_be_fullcalendar .fc-sat").addClass("bookmify_be_color");break;case 7:e(".bookmify_be_fullcalendar .fc-sun").addClass("bookmify_be_color")}}),this.jumpToRight()},jumpToRight:function(){var a=e(window).width();e(".bookmify_be_fullcalendar .fc-view").hasClass("fc-month-view")&&e(".bookmify_be_fullcalendar_wrap .event_hover_info").each(function(){var t=e(this),r=t.width(),l=t.parent();l.width()+r+l.offset().left>a?t.addClass("reserved"):t.removeClass("reserved")})},perfectScrollBar:function(){},bookmifyBeInitCalendar:function(){var a=this,t=e(".bookmify_hdn_time_interval").val();e(".bookmify_be_fullcalendar").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay,listWeek"},allDaySlot:!1,slotEventOverlap:!1,slotLabelFormat:"",listDayAltFormat:"",defaultDate:new Date,navLinks:!0,editable:!1,eventLimit:!0,timeFormat:"H:mm",fixedWeekCount:!1,firstDay:1,viewRender:function(e){a.cache.filterStartDate=e.start.format("YYYY-MM-DD"),a.cache.filterEndDate=e.end.format("YYYY-MM-DD"),a.getEvents()},eventRender:function(t,r){var l;void 0===t.color?l="":(l=t.color,r.find(".fc-content").addClass("hascolor")),r.find(".fc-content").prepend('<div class="fc-color-container" style="background-color:'+l+'"></div>');var c=parseInt(t.count),i='<div class="customer_wrap">';1===c?(i+='<div class="customer_name">'+t.customer+"</div>",i+='<div class="customer_email">'+t.customer_email+"</div>",i+='<div class="customer_phone">'+t.customer_phone+"</div>"):c>1&&(i+='<div class="customer_group">'+c+" "+t.group+"</div>"),i+="</div>";var s=new Date(t.start),o=s.getUTCHours(),n=s.getUTCMinutes(),f=new Date(t.end),d=f.getUTCHours(),h=f.getUTCMinutes(),p=o>9?o:"0"+o,m=n>9?n:"0"+n,u=d>9?d:"0"+d,v=h>9?h:"0"+h,C="";C+='<div class="status_holder">',C+='<label class="'+t.status+'">',C+=e(".bookmify_be_hidden_info .icon."+t.status).html(),C+='<span class="text">',C+=t.status,C+="</span>",C+="</label>",C+="</div>",C+=e(".bookmify_be_hidden_info .btn_wrap").html();var _="";t.employee_img&&(_="has_image");var y='<div class="event_hover_info" data-entity-id="'+t.id+'">';y+='<div class="event_hover_inner">',y+='<div class="header_wrap">'+C+"</div>",y+='<div class="content_holder">',y+='<div class="title_holder">'+t.title+"</div>",y+='<div class="time_holder">'+p+":"+m+" - "+u+":"+v+"</div>",y+=i,y+='<div class="emp_location">'+t.location+"</div>",y+="</div>",y+='<div class="footer_holder '+_+'">',y+='<div class="emp_name"><span class="emp_hold">'+a.employee+'</span><span class="emp_title">'+t.employee+"</span></div>",""!==_&&(y+='<div class="emp_img" style="background-image:url('+t.employee_img+')"></div>'),y+="</div>",y+="</div>",y+="</div>",r.find(".fc-content").after(y)},eventSources:[],slotDuration:t})},imgToSvg:function(){e("img.bookmify_fe_svg").each(function(){var a=e(this),t=a.attr("class"),r=a.attr("src");e.get(r,function(r){var l=e(r).find("svg");void 0!==t&&(l=l.attr("class",t+" replaced-svg")),l=l.removeAttr("xmlns:a"),a.replaceWith(l)},"xml")})}};e(window).resize(function(){a.jumpToRight()}),e(document).ready(function(){a.init()})}(jQuery);